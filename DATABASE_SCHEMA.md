# ğŸ“‹ FIRESTORE DATABASE SCHEMA

## ğŸ¯ IMPORTANT: Collections Auto-Create

**You DON'T need to manually create collections!**

Collections will be created automatically when you:
- Create your first lead â†’ `leads` collection created
- Create your first region â†’ `regions` collection created
- Create your first user â†’ `user` collection created

---

## ğŸ“Š COLLECTION: `leads`

### **Field Structure:**

```javascript
{
  // Document ID (auto-generated by Firestore)
  id: "auto-generated-id",
  
  // Core Details
  schoolName: "ABC International School",
  regionId: "region-doc-id",
  regionName: "North Zone",
  address: "123 Main Street, City",
  zipCode: "560001",
  landmark: "Near City Mall",  // Optional
  contactPerson: "John Doe",
  contactEmail: "john@school.com",  // Optional
  contactPhone: "9876543210",
  isChain: false,
  chainName: "",  // Optional, only if isChain = true
  remarks: "Initial contact made",
  googlePlaceId: null,  // Optional, for future Google Maps
  
  // Ownership & Status
  status: "PENDING",  // PENDING | LOCKED | POOL | CONVERTED | CANCELLED
  stage: "NEW",  // NEW | CONTACTED | DEMO_SCHEDULED | DEMO_SHOWED | QUOTATION_SENT | NEGOTIATION | CONVERTED | CANCELLED | EXPIRED
  assignedToUserId: "user-doc-id",  // Optional
  assignedToName: "Jane Smith",  // Optional
  lockedUntil: 1234567890000,  // Timestamp, optional
  
  // Meta
  createdAt: 1234567890000,  // Timestamp
  createdBy: "user-doc-id",
  updates: [
    {
      id: "update-id",
      status: "Demo Showed",
      remarks: "Client interested",
      timestamp: 1234567890000,
      updatedBy: "user-doc-id"
    }
  ]
}
```

### **Field Types:**

| Field | Type | Required | Default |
|-------|------|----------|---------|
| schoolName | string | âœ… Yes | - |
| regionId | string | âœ… Yes | - |
| regionName | string | âœ… Yes | - |
| address | string | âœ… Yes | - |
| zipCode | string | âœ… Yes | - |
| landmark | string | âŒ No | "" |
| contactPerson | string | âœ… Yes | - |
| contactEmail | string | âŒ No | "" |
| contactPhone | string | âœ… Yes | - |
| isChain | boolean | âœ… Yes | false |
| chainName | string | âŒ No | "" |
| remarks | string | âŒ No | "" |
| googlePlaceId | string/null | âŒ No | null |
| status | string | âœ… Yes | "PENDING" |
| stage | string | âœ… Yes | "NEW" |
| assignedToUserId | string | âŒ No | - |
| assignedToName | string | âŒ No | - |
| lockedUntil | number | âŒ No | - |
| createdAt | number | âœ… Yes | Date.now() |
| createdBy | string | âœ… Yes | - |
| updates | array | âœ… Yes | [] |

---

## ğŸ“Š COLLECTION: `regions`

### **Field Structure:**

```javascript
{
  // Document ID (auto-generated)
  id: "auto-generated-id",
  
  name: "North Zone",
  isActive: true,
  remarks: "Covers northern districts",
  createdAt: 1234567890000
}
```

### **Field Types:**

| Field | Type | Required | Default |
|-------|------|----------|---------|
| name | string | âœ… Yes | - |
| isActive | boolean | âœ… Yes | true |
| remarks | string | âŒ No | "" |
| createdAt | number | âœ… Yes | Date.now() |

---

## ğŸ“Š COLLECTION: `user`

### **Field Structure:**

```javascript
{
  // Document ID = Firebase Auth UID
  id: "firebase-auth-uid",
  
  email: "user@example.com",
  fullName: "John Doe",
  role: "distributor",  // admin | distributor | user
  defaultLockInMonths: 3,  // 1 | 3 | 6
  isActive: true,
  createdAt: 1234567890000
}
```

### **Field Types:**

| Field | Type | Required | Default |
|-------|------|----------|---------|
| id | string | âœ… Yes | Auth UID |
| email | string | âœ… Yes | - |
| fullName | string | âœ… Yes | - |
| role | string | âœ… Yes | - |
| defaultLockInMonths | number | âœ… Yes | 3 |
| isActive | boolean | âœ… Yes | true |
| createdAt | number | âœ… Yes | Date.now() |

---

## ğŸš€ HOW TO GET STARTED

### **Option 1: Use the App (Recommended)**

1. **Create First Admin User:**
   - Go to Firebase Console â†’ Authentication
   - Add user manually with email/password
   - Note the UID

2. **Create User Document:**
   - Go to Firestore Database
   - Create collection: `user`
   - Document ID: (paste the UID from step 1)
   - Add fields:
     ```
     email: "admin@example.com"
     fullName: "Admin User"
     role: "admin"
     defaultLockInMonths: 3
     isActive: true
     createdAt: (current timestamp)
     ```

3. **Login to App:**
   - Use the email/password you created
   - You'll be logged in as admin

4. **Create Data Through App:**
   - Create regions (Admin â†’ Regions)
   - Create users (Admin â†’ Users)
   - Create leads (User â†’ Create Lead)

### **Option 2: Manual Creation (For Testing)**

**Create Sample Region:**
```javascript
// In Firebase Console
{
  name: "North Zone",
  isActive: true,
  remarks: "",
  createdAt: Date.now()
}
```

**Create Sample Lead:**
```javascript
// In Firebase Console
{
  schoolName: "Test School",
  regionId: "region-doc-id-here",
  regionName: "North Zone",
  address: "123 Test Street",
  zipCode: "560001",
  landmark: "",
  contactPerson: "Test Person",
  contactEmail: "",
  contactPhone: "9876543210",
  isChain: false,
  chainName: "",
  remarks: "",
  googlePlaceId: null,
  status: "PENDING",
  stage: "NEW",
  createdAt: Date.now(),
  createdBy: "user-id-here",
  updates: []
}
```

---

## âœ… RECOMMENDED APPROACH

**Don't manually create collections!**

Instead:

1. **Create Admin User** (in Firebase Authentication + Firestore)
2. **Login to App** as admin
3. **Use the app** to create:
   - Regions
   - Users
   - Leads

This ensures:
- âœ… All fields are correct
- âœ… Validation is applied
- âœ… Relationships are maintained
- âœ… No typos or missing fields

---

## ğŸ¯ NEXT STEPS

Since you have no leads yet:

1. **Skip the migration** (nothing to migrate)
2. **Create admin user** in Firebase
3. **Login to app**
4. **Create regions** through app
5. **Create users** through app
6. **Create leads** through app

**The app will create all collections automatically with correct structure!**

---

## ğŸ“ QUICK START CHECKLIST

- [ ] Create admin user in Firebase Authentication
- [ ] Create user document in Firestore (collection: `user`)
- [ ] Login to app with admin credentials
- [ ] Create first region (Admin â†’ Regions)
- [ ] Create first distributor user (Admin â†’ Users)
- [ ] Login as distributor
- [ ] Create first lead (User â†’ Create Lead)
- [ ] âœ… All collections now exist with correct structure!

---

**Need help creating the admin user? Let me know!**
